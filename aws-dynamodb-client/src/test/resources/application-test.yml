# DynamoDB 테스트 환경 설정
# LocalStack 및 통합 테스트용 최적화 설정

aws:
  dynamodb:
    # LocalStack 엔드포인트 설정
    endpoint: "http://localhost:4566"
    
    # 테스트용 설정
    table-prefix: "test-"
    table-suffix: ""
    enable-point-in-time-recovery: false
    tags:
      Environment: "test"
      Application: "awskit"
      ManagedBy: "spring-boot"
    
    # 클라이언트 설정 (테스트용)
    client-config:
      enable-metrics: false
      enable-client-side-monitoring: false
      enable-request-compression: false
      enable-client-caching: false
      enable-request-logging: true
      enable-response-logging: true
    
    # 연결 설정 (테스트용 빠른 설정)
    connection-config:
      max-connections: 5
      connection-timeout: PT2S
      socket-timeout: PT5S
      connection-acquisition-timeout: PT2S
      connection-time-to-live: PT1M
      connection-max-idle-time: PT30S
      tcp-keep-alive: false
      enable-http2: false
    
    # 재시도 설정 (테스트용 빠른 실패)
    retry-config:
      max-retries: 1
      base-delay: PT0.01S
      max-backoff-time: PT1S
      backoff-strategy: "FIXED"
      enable-adaptive-retry: false
      enable-throttle-retry: false
      enable-circuit-breaker: false
    
    # 테이블 설정
    table-config:
      billing-mode: "PAY_PER_REQUEST"
      read-capacity-units: 1
      write-capacity-units: 1
      enable-deletion-protection: false
      enable-streams: false
    
    # 쿼리 설정
    query-config:
      default-page-size: 10
      scan-timeout: PT30S
      query-timeout: PT5S
      consistent-read: true
      enable-parallel-scan: false
      total-segments: 1
    
    # 배치 설정
    batch-config:
      batch-write-size: 5
      batch-read-size: 10
      batch-flush-interval: PT0.1S
      enable-batching: true
      max-retry-attempts: 1
      retry-delay: PT0.01S
    
    # 용량 관리 설정
    capacity-config:
      enable-auto-scaling: false
      enable-rate-limiting: false
    
    # 지역 설정
    region-config:
      region: "us-east-1"
      access-key: "test"
      secret-key: "test"
      enable-cross-region-replication: false
      enable-global-tables: false
      use-fips-endpoint: false
      use-dual-stack-endpoint: false
    
    # 모니터링 설정 (테스트용 최소화)
    monitoring-config:
      enable-cloud-watch-metrics: false
      enable-x-ray-tracing: false
      enable-health-check: false
      enable-performance-monitoring: true
      slow-query-threshold: PT0.1S
      log-slow-queries: true
      enable-alerts: false

# 테스트 로깅 설정
logging:
  level:
    com.ryuqq.aws.dynamodb: DEBUG
    software.amazon.awssdk: DEBUG
    org.testcontainers: INFO
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# 테스트 프로필별 설정
spring:
  profiles:
    active: test
  main:
    lazy-initialization: true

# JUnit 설정
junit:
  jupiter:
    execution:
      parallel:
        enabled: true
        mode:
          default: concurrent
        config:
          strategy: dynamic